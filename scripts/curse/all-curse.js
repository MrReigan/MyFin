// Данные для карточек товаров
const all_curse = [
  // Все курсы
  {
    level: "Начинающий",
    price: "Бесплатный",
    rating: "4.9",
    gone: "5",
    img: "../images/card-img/curse-3.png",
    title: "Первый шаг в мире финансов",
    info: "5 лекций • 0 аудио • 0 видео",
    id: "1",
    a: "./first-step.html"
  },
];

// Контейнер для карточек товаров
const container = document.getElementById("product-container-all_curse");

// Функция для обновления состояния кнопки избранного
function updateButtonState(button, productId) {
  const favorites = JSON.parse(localStorage.getItem("favorites")) || [];

  if (favorites.includes(productId)) {
    button.classList.add("favorite-active"); // Добавляем класс для закрашенной иконки
  } else {
    button.classList.remove("favorite-active"); // Убираем класс
  }
}

// Функция для добавления/удаления товара из избранного
function toggleFavorite(productId) {
  let favorites = JSON.parse(localStorage.getItem("favorites")) || [];

  if (favorites.includes(productId)) {
    favorites = favorites.filter((id) => id !== productId); // Удаляем товар
  } else {
    favorites.push(productId); // Добавляем товар
  }

  localStorage.setItem("favorites", JSON.stringify(favorites));
}

// Генерация карточек товаров
let productHTML = "";

all_curse.forEach(({ level, price, rating, gone, img, title, info, id, a }) => {
  productHTML += `
      <div class="card item" data-product-id="${id}">
        <a href="${a}">
          <div class="card-img">
            <img src="${img}" alt="${title}" />
          </div>
          <div class="card-info">
            <div class="status">
              <p>${level}</p>
              <p>${price}</p>
            </div>
            <div class="rating">
              <div class="rating-1">
                <p>
                  <svg width="12" height="13" viewBox="0 0 12 13" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5.54436 1.09065C5.68526 0.791246 5.75571 0.641542 5.85135 0.593711C5.93456 0.552096 6.03124 0.552096 6.11445 0.593711C6.21009 0.641542 6.28054 0.791246 6.42144 1.09065L7.7582 3.93121C7.7998 4.0196 7.8206 4.0638 7.85099 4.09811C7.87791 4.1285 7.91018 4.15311 7.94604 4.1706C7.98653 4.19035 8.03302 4.19748 8.12601 4.21173L11.1162 4.67016C11.431 4.71843 11.5885 4.74257 11.6613 4.82324C11.7247 4.89342 11.7545 4.98986 11.7425 5.08571C11.7286 5.19587 11.6146 5.31232 11.3867 5.54521L9.22378 7.75486C9.15635 7.82374 9.12264 7.85818 9.10089 7.89916C9.08163 7.93544 9.06927 7.9753 9.06451 8.01653C9.05913 8.06309 9.06708 8.11174 9.08299 8.20904L9.59333 11.3301C9.64716 11.6593 9.67407 11.8238 9.62349 11.9215C9.57948 12.0065 9.50126 12.0661 9.41061 12.0837C9.30641 12.104 9.1655 12.0263 8.88368 11.8708L6.21053 10.3963C6.12724 10.3503 6.0856 10.3274 6.04172 10.3183C6.00288 10.3104 5.96292 10.3104 5.92407 10.3183C5.8802 10.3274 5.83856 10.3503 5.75527 10.3963L3.08212 11.8708C2.8003 12.0263 2.65938 12.104 2.55519 12.0837C2.46454 12.0661 2.38631 12.0065 2.34231 11.9215C2.29173 11.8238 2.31864 11.6593 2.37247 11.3301L2.88281 8.20904C2.89872 8.11174 2.90667 8.06309 2.90129 8.01653C2.89652 7.9753 2.88417 7.93544 2.86491 7.89916C2.84315 7.85818 2.80944 7.82374 2.74202 7.75485L0.579146 5.54521C0.351186 5.31232 0.237206 5.19587 0.223336 5.08571C0.211269 4.98986 0.241081 4.89342 0.304474 4.82324C0.377334 4.74257 0.534771 4.71843 0.849646 4.67016L3.83978 4.21173C3.93277 4.19748 3.97927 4.19035 4.01976 4.1706C4.05561 4.15311 4.08789 4.1285 4.1148 4.09811C4.1452 4.0638 4.166 4.0196 4.20759 3.93121L5.54436 1.09065Z" fill="currentColor" />
                  </svg>
                  ${rating}
                </p>
              </div>
              <div class="rating-2">
                <p>
                  <svg width="13" height="14" viewBox="0 0 13 14" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M6.84304 2.3951C5.71153 2.3951 4.79426 3.31237 4.79426 4.44388C4.79426 5.57539 5.71153 6.49266 6.84304 6.49266C7.97455 6.49266 8.89182 5.57539 8.89182 4.44388C8.89182 3.31237 7.97455 2.3951 6.84304 2.3951ZM3.12962 4.44388C3.12962 2.39302 4.79218 0.730469 6.84304 0.730469C8.8939 0.730469 10.5565 2.39302 10.5565 4.44388C10.5565 6.49475 8.8939 8.1573 6.84304 8.1573C4.79218 8.1573 3.12962 6.49475 3.12962 4.44388ZM5.11215 8.73346C5.15494 8.73349 5.19836 8.73351 5.24243 8.73351H8.44365C8.48772 8.73351 8.53114 8.73349 8.57393 8.73346C9.33994 8.73302 9.90464 8.73269 10.389 8.87963C11.4735 9.20861 12.3222 10.0573 12.6512 11.1418C12.7981 11.6262 12.7978 12.1909 12.7974 12.9569C12.7973 12.9997 12.7973 13.0431 12.7973 13.0872C12.7973 13.5469 12.4247 13.9195 11.965 13.9195C11.5053 13.9195 11.1327 13.5469 11.1327 13.0872C11.1327 12.1331 11.1236 11.8406 11.0582 11.625C10.8906 11.0725 10.4583 10.6402 9.90582 10.4726C9.69022 10.4072 9.3977 10.3981 8.44365 10.3981H5.24243C4.28837 10.3981 3.99586 10.4072 3.78026 10.4726C3.22778 10.6402 2.79543 11.0725 2.62784 11.625C2.56244 11.8406 2.5534 12.1331 2.5534 13.0872C2.5534 13.5469 2.18076 13.9195 1.72109 13.9195C1.26141 13.9195 0.88877 13.5469 0.88877 13.0872C0.88877 13.0431 0.888745 12.9997 0.88872 12.9569C0.888274 12.1909 0.887945 11.6262 1.03489 11.1418C1.36387 10.0573 2.21254 9.20861 3.29704 8.87963C3.78143 8.73269 4.34614 8.73302 5.11215 8.73346Z" fill="currentColor" />
                  </svg>
                  ${gone}
                </p>
              </div>
            </div>
          </div>
        </a>
        <div class="card-title">
          <h3>${title}</h3>
          <button class="favorite-btn">
            <svg width="37" height="36" viewBox="0 0 37 36" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="0.987305" y="0.0703125" width="35.5705" height="35.5705" rx="8.44221" fill="#1C1C1D" />
              <path class="favorite-icon" d="M11.3828 13.4227C11.3828 11.6497 11.3828 10.7632 11.7279 10.086C12.0314 9.49031 12.5157 9.006 13.1114 8.70248C13.7886 8.35742 14.6751 8.35742 16.4481 8.35742H21.0914C22.8644 8.35742 23.7509 8.35742 24.4281 8.70248C25.0238 9.006 25.5081 9.49031 25.8116 10.086C26.1567 10.7632 26.1567 11.6497 26.1567 13.4227V27.3524L18.7697 23.1313L11.3828 27.3524V13.4227Z" fill="currentColor" stroke="currentColor" stroke-opacity="0.35" stroke-width="2.56098" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </button>
        </div>
        <div class="sub-title">
          <p>${info}</p>
        </div>
      </div>
    `;
});

container.innerHTML = productHTML;

// Добавляем обработчики для кнопок избранного
const favoriteButtons = document.querySelectorAll(".favorite-btn");
favoriteButtons.forEach((button) => {
  const productCard = button.closest(".card");
  const productId = productCard.getAttribute("data-product-id");

  // Обновляем состояние кнопки при загрузке страницы
  updateButtonState(button, productId);

  button.addEventListener("click", () => {
    toggleFavorite(productId);
    updateButtonState(button, productId); // Обновляем состояние кнопки после клика
  });
});
